"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

require("source-map-support/register");

var _lodash = _interopRequireDefault(require("lodash"));

var _bluebird = _interopRequireDefault(require("bluebird"));

var _chai = _interopRequireDefault(require("chai"));

var _chaiAsPromised = _interopRequireDefault(require("chai-as-promised"));

var _wd = _interopRequireDefault(require("wd"));

var _requestPromise = _interopRequireDefault(require("request-promise"));

var _main = require("../lib/main");

var _helpers = require("./helpers");

var _appiumBaseDriver = require("appium-base-driver");

var _appiumFakeDriver = require("appium-fake-driver");

var _sinon = _interopRequireDefault(require("sinon"));

_chai.default.use(_chaiAsPromised.default);

const should = _chai.default.should();

const shouldStartServer = process.env.USE_RUNNING_SERVER !== '0';
const caps = {
  platformName: 'Fake',
  deviceName: 'Fake',
  app: _helpers.TEST_FAKE_APP
};
describe('FakeDriver - via HTTP', function () {
  let server = null;
  const baseUrl = `http://${_helpers.TEST_HOST}:${_helpers.TEST_PORT}/wd/hub/session`;
  before(async function () {
    if (shouldStartServer) {
      let args = {
        port: _helpers.TEST_PORT,
        host: _helpers.TEST_HOST
      };
      server = await (0, _main.main)(args);
    }
  });
  after(async function () {
    if (server) {
      await server.close();
    }
  });
  describe('session handling', function () {
    it('should start and stop a session', async function () {
      let driver = _wd.default.promiseChainRemote(_helpers.TEST_HOST, _helpers.TEST_PORT);

      let [sessionId] = await driver.init(caps);
      should.exist(sessionId);
      sessionId.should.be.a('string');
      await driver.quit();
      await driver.title().should.eventually.be.rejectedWith(/terminated/);
    });
    it('should be able to run two FakeDriver sessions simultaneously', async function () {
      let driver1 = _wd.default.promiseChainRemote(_helpers.TEST_HOST, _helpers.TEST_PORT);

      let [sessionId1] = await driver1.init(caps);
      should.exist(sessionId1);
      sessionId1.should.be.a('string');

      let driver2 = _wd.default.promiseChainRemote(_helpers.TEST_HOST, _helpers.TEST_PORT);

      let [sessionId2] = await driver2.init(caps);
      should.exist(sessionId2);
      sessionId2.should.be.a('string');
      sessionId1.should.not.equal(sessionId2);
      await driver1.quit();
      await driver2.quit();
    });
    it('should not be able to run two FakeDriver sessions simultaneously when one is unique', async function () {
      let uniqueCaps = _lodash.default.clone(caps);

      uniqueCaps.uniqueApp = true;

      let driver1 = _wd.default.promiseChainRemote(_helpers.TEST_HOST, _helpers.TEST_PORT);

      let [sessionId1] = await driver1.init(uniqueCaps);
      should.exist(sessionId1);
      sessionId1.should.be.a('string');

      let driver2 = _wd.default.promiseChainRemote(_helpers.TEST_HOST, _helpers.TEST_PORT);

      await driver2.init(caps).should.eventually.be.rejected;
      await driver1.quit();
    });
    it('should use the newCommandTimeout of the inner Driver on session creation', async function () {
      let driver = _wd.default.promiseChainRemote(_helpers.TEST_HOST, _helpers.TEST_PORT);

      let localCaps = Object.assign({
        newCommandTimeout: 0.25
      }, caps);
      let [sessionId] = await driver.init(localCaps);
      should.exist(sessionId);
      await _bluebird.default.delay(250);
      await driver.source().should.eventually.be.rejectedWith(/terminated/);
    });
    it('should accept valid W3C capabilities and start a W3C session', async function () {
      const w3cCaps = {
        capabilities: {
          alwaysMatch: {
            platformName: 'Fake'
          },
          firstMatch: [{
            'appium:deviceName': 'Fake',
            'appium:app': _helpers.TEST_FAKE_APP
          }]
        }
      };
      const {
        status,
        value,
        sessionId
      } = await _requestPromise.default.post({
        url: baseUrl,
        json: w3cCaps
      });
      should.not.exist(status);
      should.not.exist(sessionId);
      value.sessionId.should.be.a.string;
      value.should.exist;
      value.capabilities.should.deep.equal({
        platformName: 'Fake',
        deviceName: 'Fake',
        app: _helpers.TEST_FAKE_APP
      });
      const {
        status: screenshotStatus,
        value: screenshotValue
      } = await (0, _requestPromise.default)({
        url: `${baseUrl}/${value.sessionId}/screenshot`,
        json: true
      });
      should.not.exist(screenshotStatus);
      screenshotValue.should.equal('hahahanotreallyascreenshot');
      const {
        statusCode,
        error
      } = await _requestPromise.default.post({
        url: `${baseUrl}/${value.sessionId}/execute/async`,
        json: {
          script: '',
          args: ['a']
        }
      }).should.eventually.be.rejected;
      statusCode.should.equal(405);
      const {
        error: errorMessage,
        message,
        stacktrace
      } = error.value;
      errorMessage.should.match(/unknown method/);
      message.should.match(/Method has not yet been implemented/);
      stacktrace.should.match(/FakeDriver.executeCommand/);
      await _requestPromise.default.delete({
        url: `${baseUrl}/${value.sessionId}`
      });
    });
    it('should reject invalid W3C capabilities and respond with a 400 Bad Parameters error', async function () {
      const badW3Ccaps = {
        capabilities: {
          alwaysMatch: {},
          firstMatch: [{
            'appium:deviceName': 'Fake',
            'appium:app': _helpers.TEST_FAKE_APP
          }]
        }
      };
      const {
        statusCode,
        error
      } = await _requestPromise.default.post({
        url: baseUrl,
        json: badW3Ccaps
      }).should.eventually.be.rejected;
      statusCode.should.equal(400);
      error.value.message.should.match(/can't be blank/);
    });
    it('should accept a combo of W3C and JSONWP capabilities but default to W3C', async function () {
      const combinedCaps = {
        'desiredCapabilities': { ...caps
        },
        'capabilities': {
          'alwaysMatch': { ...caps
          },
          'firstMatch': [{
            w3cParam: 'w3cParam'
          }]
        }
      };
      const {
        status,
        value,
        sessionId
      } = await _requestPromise.default.post({
        url: baseUrl,
        json: combinedCaps
      });
      should.not.exist(status);
      should.not.exist(sessionId);
      value.sessionId.should.exist;
      value.capabilities.should.deep.equal({ ...caps,
        w3cParam: 'w3cParam'
      });
      await _requestPromise.default.delete({
        url: `${baseUrl}/${value.sessionId}`
      });
    });
    it('should accept a combo of W3C and JSONWP and if JSONWP has extraneous keys, they should be merged into W3C capabilities', async function () {
      const combinedCaps = {
        'desiredCapabilities': { ...caps,
          automationName: 'Fake',
          anotherParam: 'Hello'
        },
        'capabilities': {
          'alwaysMatch': { ...caps
          },
          'firstMatch': [{
            w3cParam: 'w3cParam'
          }]
        }
      };
      const {
        sessionId,
        status,
        value
      } = await _requestPromise.default.post({
        url: baseUrl,
        json: combinedCaps
      });
      should.not.exist(sessionId);
      should.not.exist(status);
      value.sessionId.should.exist;
      value.capabilities.should.deep.equal({ ...caps,
        automationName: 'Fake',
        anotherParam: 'Hello',
        w3cParam: 'w3cParam'
      });
      await _requestPromise.default.delete({
        url: `${baseUrl}/${value.sessionId}`
      });
    });
    it('should reject bad W3C capabilities with a BadParametersError (400)', async function () {
      const w3cCaps = {
        capabilities: {
          alwaysMatch: { ...caps,
            automationName: 'BadAutomationName'
          }
        }
      };
      const {
        error,
        statusCode,
        response
      } = await _requestPromise.default.post({
        url: baseUrl,
        json: w3cCaps
      }).should.eventually.be.rejected;
      response.headers['content-type'].should.match(/application\/json/);
      const {
        message
      } = error.value;
      message.should.match(/BadAutomationName not part of/);
      statusCode.should.equal(400);
    });
    it('should accept capabilities that are provided in the firstMatch array', async function () {
      const w3cCaps = {
        capabilities: {
          alwaysMatch: {},
          firstMatch: [{}, { ...caps
          }]
        }
      };
      const {
        value,
        sessionId,
        status
      } = await _requestPromise.default.post({
        url: baseUrl,
        json: w3cCaps
      });
      should.not.exist(status);
      should.not.exist(sessionId);
      value.capabilities.should.deep.equal(caps);
      await _requestPromise.default.delete({
        url: `${baseUrl}/${value.sessionId}`
      });
    });
    it('should fall back to MJSONWP if w3c caps are invalid', async function () {
      const combinedCaps = {
        desiredCapabilities: { ...caps
        },
        capabilities: {
          alwaysMatch: {},
          firstMatch: [{}, { ...caps,
            deviceName: null
          }]
        }
      };
      const {
        value,
        sessionId,
        status
      } = await _requestPromise.default.post({
        url: baseUrl,
        json: combinedCaps
      });
      status.should.exist;
      sessionId.should.exist;
      value.should.deep.equal(caps);
      await _requestPromise.default.delete({
        url: `${baseUrl}/${sessionId}`
      });
    });
    it('should fall back to MJSONWP if Inner Driver is not ready for W3C', async function () {
      const combinedCaps = {
        desiredCapabilities: { ...caps
        },
        capabilities: {
          alwaysMatch: { ...caps,
            deviceName: null
          }
        }
      };

      const createSessionStub = _sinon.default.stub(_appiumFakeDriver.FakeDriver.prototype, 'createSession').callsFake(async function (jsonwpCaps) {
        const res = await _appiumBaseDriver.BaseDriver.prototype.createSession.call(this, jsonwpCaps);
        this.protocol.should.equal('MJSONWP');
        return res;
      });

      const {
        value,
        sessionId,
        status
      } = await _requestPromise.default.post({
        url: baseUrl,
        json: combinedCaps
      });
      status.should.exist;
      sessionId.should.exist;
      value.should.deep.equal(caps);
      createSessionStub.restore();
      await _requestPromise.default.delete({
        url: `${baseUrl}/${sessionId}`
      });
    });
    it('should handle concurrent MJSONWP and W3C sessions', async function () {
      const combinedCaps = {
        desiredCapabilities: { ...caps
        },
        capabilities: {
          alwaysMatch: { ...caps
          },
          firstMatch: []
        }
      };
      const {
        sessionId: mjsonwpSessId,
        value: mjsonwpValue,
        status
      } = await _requestPromise.default.post({
        url: baseUrl,
        json: _lodash.default.omit(combinedCaps, 'capabilities')
      });
      status.should.exist;
      mjsonwpValue.should.eql(caps);
      mjsonwpSessId.should.exist;
      const {
        value
      } = await _requestPromise.default.post({
        url: baseUrl,
        json: _lodash.default.omit(combinedCaps, 'desiredCapabilities')
      });
      const w3cSessId = value.sessionId;
      w3cSessId.should.exist;
      value.capabilities.should.eql(caps);
      const mjsonwpPayload = await (0, _requestPromise.default)(`${baseUrl}/${mjsonwpSessId}`, {
        json: true
      });
      mjsonwpPayload.sessionId.should.exist;
      mjsonwpPayload.status.should.exist;
      mjsonwpPayload.value.should.eql(caps);
      const w3cPayload = await (0, _requestPromise.default)(`${baseUrl}/${w3cSessId}`, {
        json: true
      });
      should.not.exist(w3cPayload.sessionId);
      should.not.exist(w3cPayload.status);
      w3cPayload.value.should.eql(caps);
      await _requestPromise.default.delete({
        url: `${baseUrl}/${mjsonwpSessId}`
      });
      await _requestPromise.default.delete({
        url: `${baseUrl}/${w3cSessId}`
      });
    });
  });
});
describe('Logsink', function () {
  let server = null;
  let logs = [];

  let logHandler = function (level, message) {
    logs.push([level, message]);
  };

  let args = {
    port: _helpers.TEST_PORT,
    host: _helpers.TEST_HOST,
    logHandler
  };
  before(async function () {
    server = await (0, _main.main)(args);
  });
  after(async function () {
    await server.close();
  });
  it('should send logs to a logHandler passed in by a parent package', function () {
    logs.length.should.be.above(1);
    let welcomeIndex = logs[0][1].includes('versions of node') ? 1 : 0;
    logs[welcomeIndex].length.should.equal(2);
    logs[welcomeIndex][1].should.include('Welcome to Appium');
  });
});require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvZHJpdmVyLWUyZS1zcGVjcy5qcyJdLCJuYW1lcyI6WyJjaGFpIiwidXNlIiwiY2hhaUFzUHJvbWlzZWQiLCJzaG91bGQiLCJzaG91bGRTdGFydFNlcnZlciIsInByb2Nlc3MiLCJlbnYiLCJVU0VfUlVOTklOR19TRVJWRVIiLCJjYXBzIiwicGxhdGZvcm1OYW1lIiwiZGV2aWNlTmFtZSIsImFwcCIsIlRFU1RfRkFLRV9BUFAiLCJkZXNjcmliZSIsInNlcnZlciIsImJhc2VVcmwiLCJURVNUX0hPU1QiLCJURVNUX1BPUlQiLCJiZWZvcmUiLCJhcmdzIiwicG9ydCIsImhvc3QiLCJhZnRlciIsImNsb3NlIiwiaXQiLCJkcml2ZXIiLCJ3ZCIsInByb21pc2VDaGFpblJlbW90ZSIsInNlc3Npb25JZCIsImluaXQiLCJleGlzdCIsImJlIiwiYSIsInF1aXQiLCJ0aXRsZSIsImV2ZW50dWFsbHkiLCJyZWplY3RlZFdpdGgiLCJkcml2ZXIxIiwic2Vzc2lvbklkMSIsImRyaXZlcjIiLCJzZXNzaW9uSWQyIiwibm90IiwiZXF1YWwiLCJ1bmlxdWVDYXBzIiwiXyIsImNsb25lIiwidW5pcXVlQXBwIiwicmVqZWN0ZWQiLCJsb2NhbENhcHMiLCJPYmplY3QiLCJhc3NpZ24iLCJuZXdDb21tYW5kVGltZW91dCIsIkIiLCJkZWxheSIsInNvdXJjZSIsInczY0NhcHMiLCJjYXBhYmlsaXRpZXMiLCJhbHdheXNNYXRjaCIsImZpcnN0TWF0Y2giLCJzdGF0dXMiLCJ2YWx1ZSIsInJlcXVlc3QiLCJwb3N0IiwidXJsIiwianNvbiIsInN0cmluZyIsImRlZXAiLCJzY3JlZW5zaG90U3RhdHVzIiwic2NyZWVuc2hvdFZhbHVlIiwic3RhdHVzQ29kZSIsImVycm9yIiwic2NyaXB0IiwiZXJyb3JNZXNzYWdlIiwibWVzc2FnZSIsInN0YWNrdHJhY2UiLCJtYXRjaCIsImRlbGV0ZSIsImJhZFczQ2NhcHMiLCJjb21iaW5lZENhcHMiLCJ3M2NQYXJhbSIsImF1dG9tYXRpb25OYW1lIiwiYW5vdGhlclBhcmFtIiwicmVzcG9uc2UiLCJoZWFkZXJzIiwiZGVzaXJlZENhcGFiaWxpdGllcyIsImNyZWF0ZVNlc3Npb25TdHViIiwic2lub24iLCJzdHViIiwiRmFrZURyaXZlciIsInByb3RvdHlwZSIsImNhbGxzRmFrZSIsImpzb253cENhcHMiLCJyZXMiLCJCYXNlRHJpdmVyIiwiY3JlYXRlU2Vzc2lvbiIsImNhbGwiLCJwcm90b2NvbCIsInJlc3RvcmUiLCJtanNvbndwU2Vzc0lkIiwibWpzb253cFZhbHVlIiwib21pdCIsImVxbCIsInczY1Nlc3NJZCIsIm1qc29ud3BQYXlsb2FkIiwidzNjUGF5bG9hZCIsImxvZ3MiLCJsb2dIYW5kbGVyIiwibGV2ZWwiLCJwdXNoIiwibGVuZ3RoIiwiYWJvdmUiLCJ3ZWxjb21lSW5kZXgiLCJpbmNsdWRlcyIsImluY2x1ZGUiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBQSxjQUFLQyxHQUFMLENBQVNDLHVCQUFUOztBQUVBLE1BQU1DLE1BQU0sR0FBR0gsY0FBS0csTUFBTCxFQUFmOztBQUNBLE1BQU1DLGlCQUFpQixHQUFHQyxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsa0JBQVosS0FBbUMsR0FBN0Q7QUFDQSxNQUFNQyxJQUFJLEdBQUc7QUFBQ0MsRUFBQUEsWUFBWSxFQUFFLE1BQWY7QUFBdUJDLEVBQUFBLFVBQVUsRUFBRSxNQUFuQztBQUEyQ0MsRUFBQUEsR0FBRyxFQUFFQztBQUFoRCxDQUFiO0FBRUFDLFFBQVEsQ0FBQyx1QkFBRCxFQUEwQixZQUFZO0FBQzVDLE1BQUlDLE1BQU0sR0FBRyxJQUFiO0FBQ0EsUUFBTUMsT0FBTyxHQUFJLFVBQVNDLGtCQUFVLElBQUdDLGtCQUFVLGlCQUFqRDtBQUNBQyxFQUFBQSxNQUFNLENBQUMsa0JBQWtCO0FBQ3ZCLFFBQUlkLGlCQUFKLEVBQXVCO0FBQ3JCLFVBQUllLElBQUksR0FB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LFVBQU1SLE1BQU0sQ0FBQ1MsS0FBUCxFQUFOO0FBQ0QsR0FGSSxDQUFMO0FBSUFDLEVBQUFBLEVBQUUsQ0FBQyxnRUFBRCxFQUFtRSxZQUFZO0FBQy9FaUYsSUFBQUEsSUFBSSxDQUFDSSxNQUFMLENBQVkxRyxNQUFaLENBQW1CNEIsRUFBbkIsQ0FBc0IrRSxLQUF0QixDQUE0QixDQUE1QjtBQUNBLFFBQUlDLFlBQVksR0FBR04sSUFBSSxDQUFDLENBQUQsQ0FBSixDQUFRLENBQVIsRUFBV08sUUFBWCxDQUFvQixrQkFBcEIsSUFBMEMsQ0FBMUMsR0FBOEMsQ0FBakU7QUFDQVAsSUFBQUEsSUFBSSxDQUFDTSxZQUFELENBQUosQ0FBbUJGLE1BQW5CLENBQTBCMUcsTUFBMUIsQ0FBaUN1QyxLQUFqQyxDQUF1QyxDQUF2QztBQUNBK0QsSUFBQUEsSUFBSSxDQUFDTSxZQUFELENBQUosQ0FBbUIsQ0FBbkIsRUFBc0I1RyxNQUF0QixDQUE2QjhHLE9BQTdCLENBQXFDLG1CQUFyQztBQUNELEdBTEMsQ0FBRjtBQU1ELENBMUJPLENBQVIiLCJzb3VyY2VzQ29udGVudCI6WyIvLyB0cmFuc3BpbGU6bW9jaGFcblxuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCBCIGZyb20gJ2JsdWViaXJkJztcbmltcG9ydCBjaGFpIGZyb20gJ2NoYWknO1xuaW1wb3J0IGNoYWlBc1Byb21pc2VkIGZyb20gJ2NoYWktYXMtcHJvbWlzZWQnO1xuaW1wb3J0IHdkIGZyb20gJ3dkJztcbmltcG9ydCByZXF1ZXN0IGZyb20gJ3JlcXVlc3QtcHJvbWlzZSc7XG5pbXBvcnQgeyBtYWluIGFzIGFwcGl1bVNlcnZlciB9IGZyb20gJy4uL2xpYi9tYWluJztcbmltcG9ydCB7IFRFU1RfRkFLRV9BUFAsIFRFU1RfSE9TVCwgVEVTVF9QT1JUIH0gZnJvbSAnLi9oZWxwZXJzJztcbmltcG9ydCB7IEJhc2VEcml2ZXIgfSBmcm9tICdhcHBpdW0tYmFzZS1kcml2ZXInO1xuaW1wb3J0IHsgRmFrZURyaXZlciB9IGZyb20gJ2FwcGl1bS1mYWtlLWRyaXZlcic7XG5pbXBvcnQgc2lub24gZnJvbSAnc2lub24nO1xuXG5jaGFpLnVzZShjaGFpQXNQcm9taXNlZCk7XG5cbmNvbnN0IHNob3VsZCA9IGNoYWkuc2hvdWxkKCk7XG5jb25zdCBzaG91bGRTdGFydFNlcnZlciA9IHByb2Nlc3MuZW52LlVTRV9SVU5OSU5HX1NFUlZFUiAhPT0gJzAnO1xuY29uc3QgY2FwcyA9IHtwbGF0Zm9ybU5hbWU6ICdGYWtlJywgZGV2aWNlTmFtZTogJ0Zha2UnLCBhcHA6IFRFU1RfRkFLRV9BUFB9O1xuXG5kZXNjcmliZSgnRmFrZURyaXZlciAtIHZpYSBIVFRQJywgZnVuY3Rpb24gKCkge1xuICBsZXQgc2VydmVyID0gbnVsbDtcbiAgY29uc3QgYmFzZVVybCA9IGBodHRwOi8vJHtURVNUX0hPU1R9OiR7VEVTVF9QT1JUfS93ZC9odWIvc2Vzc2lvbmA7XG4gIGJlZm9yZShhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHNob3VsZFN0YXJ0U2VydmVyKSB7XG4gICAgICBsZXQgYXJncyA9IHtwb3J0OiBURVNUX1BPUlQsIGhvc3Q6IFRFU1RfSE9TVH07XG4gICAgICBzZXJ2ZXIgPSBhd2FpdCBhcHBpdW1TZXJ2ZXIoYXJncyk7XG4gICAgfVxuICB9KTtcbiAgYWZ0ZXIoYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGlmIChzZXJ2ZXIpIHtcbiAgICAgIGF3YWl0IHNlcnZlci5jbG9zZSgpO1xuICAgIH1cbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3Nlc3Npb24gaGFuZGxpbmcnLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCBzdGFydCBhbmQgc3RvcCBhIHNlc3Npb24nLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgZHJpdmVyID0gd2QucHJvbWlzZUNoYWluUmVtb3RlKFRFU1RfSE9TVCwgVEVTVF9QT1JUKTtcbiAgICAgIGxldCBbc2Vzc2lvbklkXSA9IGF3YWl0IGRyaXZlci5pbml0KGNhcHMpO1xuICAgICAgc2hvdWxkLmV4aXN0KHNlc3Npb25JZCk7XG4gICAgICBzZXNzaW9uSWQuc2hvdWxkLmJlLmEoJ3N0cmluZycpO1xuICAgICAgYXdhaXQgZHJpdmVyLnF1aXQoKTtcbiAgICAgIGF3YWl0IGRyaXZlci50aXRsZSgpLnNob3VsZC5ldmVudHVhbGx5LmJlLnJlamVjdGVkV2l0aCgvdGVybWluYXRlZC8pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBiZSBhYmxlIHRvIHJ1biB0d28gRmFrZURyaXZlciBzZXNzaW9ucyBzaW11bHRhbmVvdXNseScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBkcml2ZXIxID0gd2QucHJvbWlzZUNoYWluUmVtb3RlKFRFU1RfSE9TVCwgVEVTVF9QT1JUKTtcbiAgICAgIGxldCBbc2Vzc2lvbklkMV0gPSBhd2FpdCBkcml2ZXIxLmluaXQoY2Fwcyk7XG4gICAgICBzaG91bGQuZXhpc3Qoc2Vzc2lvbklkMSk7XG4gICAgICBzZXNzaW9uSWQxLnNob3VsZC5iZS5hKCdzdHJpbmcnKTtcbiAgICAgIGxldCBkcml2ZXIyID0gd2QucHJvbWlzZUNoYWluUmVtb3RlKFRFU1RfSE9TVCwgVEVTVF9QT1JUKTtcbiAgICAgIGxldCBbc2Vzc2lvbklkMl0gPSBhd2FpdCBkcml2ZXIyLmluaXQoY2Fwcyk7XG4gICAgICBzaG91bGQuZXhpc3Qoc2Vzc2lvbklkMik7XG4gICAgICBzZXNzaW9uSWQyLnNob3VsZC5iZS5hKCdzdHJpbmcnKTtcbiAgICAgIHNlc3Npb25JZDEuc2hvdWxkLm5vdC5lcXVhbChzZXNzaW9uSWQyKTtcbiAgICAgIGF3YWl0IGRyaXZlcjEucXVpdCgpO1xuICAgICAgYXdhaXQgZHJpdmVyMi5xdWl0KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCBiZSBhYmxlIHRvIHJ1biB0d28gRmFrZURyaXZlciBzZXNzaW9ucyBzaW11bHRhbmVvdXNseSB3aGVuIG9uZSBpcyB1bmlxdWUnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgdW5pcXVlQ2FwcyA9IF8uY2xvbmUoY2Fwcyk7XG4gICAgICB1bmlxdWVDYXBzLnVuaXF1ZUFwcCA9IHRydWU7XG4gICAgICBsZXQgZHJpdmVyMSA9IHdkLnByb21pc2VDaGFpblJlbW90ZShURVNUX0hPU1QsIFRFU1RfUE9SVCk7XG4gICAgICBsZXQgW3Nlc3Npb25JZDFdID0gYXdhaXQgZHJpdmVyMS5pbml0KHVuaXF1ZUNhcHMpO1xuICAgICAgc2hvdWxkLmV4aXN0KHNlc3Npb25JZDEpO1xuICAgICAgc2Vzc2lvbklkMS5zaG91bGQuYmUuYSgnc3RyaW5nJyk7XG4gICAgICBsZXQgZHJpdmVyMiA9IHdkLnByb21pc2VDaGFpblJlbW90ZShURVNUX0hPU1QsIFRFU1RfUE9SVCk7XG4gICAgICBhd2FpdCBkcml2ZXIyLmluaXQoY2Fwcykuc2hvdWxkLmV2ZW50dWFsbHkuYmUucmVqZWN0ZWQ7XG4gICAgICBhd2FpdCBkcml2ZXIxLnF1aXQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdXNlIHRoZSBuZXdDb21tYW5kVGltZW91dCBvZiB0aGUgaW5uZXIgRHJpdmVyIG9uIHNlc3Npb24gY3JlYXRpb24nLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgZHJpdmVyID0gd2QucHJvbWlzZUNoYWluUmVtb3RlKFRFU1RfSE9TVCwgVEVTVF9QT1JUKTtcblxuICAgICAgbGV0IGxvY2FsQ2FwcyA9IE9iamVjdC5hc3NpZ24oe1xuICAgICAgICBuZXdDb21tYW5kVGltZW91dDogMC4yNSxcbiAgICAgIH0sIGNhcHMpO1xuXG4gICAgICBsZXQgW3Nlc3Npb25JZF0gPSBhd2FpdCBkcml2ZXIuaW5pdChsb2NhbENhcHMpO1xuICAgICAgc2hvdWxkLmV4aXN0KHNlc3Npb25JZCk7XG5cbiAgICAgIGF3YWl0IEIuZGVsYXkoMjUwKTtcbiAgICAgIGF3YWl0IGRyaXZlci5zb3VyY2UoKS5zaG91bGQuZXZlbnR1YWxseS5iZS5yZWplY3RlZFdpdGgoL3Rlcm1pbmF0ZWQvKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYWNjZXB0IHZhbGlkIFczQyBjYXBhYmlsaXRpZXMgYW5kIHN0YXJ0IGEgVzNDIHNlc3Npb24nLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAvLyBUcnkgd2l0aCB2YWxpZCBjYXBhYmlsaXRpZXMgYW5kIGNoZWNrIHRoYXQgaXQgcmV0dXJucyBhIHNlc3Npb24gSURcbiAgICAgIGNvbnN0IHczY0NhcHMgPSB7XG4gICAgICAgIGNhcGFiaWxpdGllczoge1xuICAgICAgICAgIGFsd2F5c01hdGNoOiB7cGxhdGZvcm1OYW1lOiAnRmFrZSd9LFxuICAgICAgICAgIGZpcnN0TWF0Y2g6IFt7J2FwcGl1bTpkZXZpY2VOYW1lJzogJ0Zha2UnLCAnYXBwaXVtOmFwcCc6IFRFU1RfRkFLRV9BUFB9XSxcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgLy8gQ3JlYXRlIHRoZSBzZXNzaW9uXG4gICAgICBjb25zdCB7c3RhdHVzLCB2YWx1ZSwgc2Vzc2lvbklkfSA9IGF3YWl0IHJlcXVlc3QucG9zdCh7dXJsOiBiYXNlVXJsLCBqc29uOiB3M2NDYXBzfSk7XG4gICAgICBzaG91bGQubm90LmV4aXN0KHN0YXR1cyk7IC8vIFRlc3QgdGhhdCBpdCdzIGEgVzNDIHNlc3Npb24gYnkgY2hlY2tpbmcgdGhhdCAnc3RhdHVzJyBpcyBub3QgaW4gdGhlIHJlc3BvbnNlXG4gICAgICBzaG91bGQubm90LmV4aXN0KHNlc3Npb25JZCk7XG4gICAgICB2YWx1ZS5zZXNzaW9uSWQuc2hvdWxkLmJlLmEuc3RyaW5nO1xuICAgICAgdmFsdWUuc2hvdWxkLmV4aXN0O1xuICAgICAgdmFsdWUuY2FwYWJpbGl0aWVzLnNob3VsZC5kZWVwLmVxdWFsKHtcbiAgICAgICAgcGxhdGZvcm1OYW1lOiAnRmFrZScsXG4gICAgICAgIGRldmljZU5hbWU6ICdGYWtlJyxcbiAgICAgICAgYXBwOiBURVNUX0ZBS0VfQVBQLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIE5vdyB1c2UgdGhhdCBzZXNzaW9uSWQgdG8gY2FsbCAvc2NyZWVuc2hvdFxuICAgICAgY29uc3Qge3N0YXR1czogc2NyZWVuc2hvdFN0YXR1cywgdmFsdWU6IHNjcmVlbnNob3RWYWx1ZX0gPSBhd2FpdCByZXF1ZXN0KHt1cmw6IGAke2Jhc2VVcmx9LyR7dmFsdWUuc2Vzc2lvbklkfS9zY3JlZW5zaG90YCwganNvbjogdHJ1ZX0pO1xuICAgICAgc2hvdWxkLm5vdC5leGlzdChzY3JlZW5zaG90U3RhdHVzKTtcbiAgICAgIHNjcmVlbnNob3RWYWx1ZS5zaG91bGQuZXF1YWwoJ2hhaGFoYW5vdHJlYWxseWFzY3JlZW5zaG90Jyk7XG5cbiAgICAgIC8vIE5vdyB1c2UgdGhhdCBzZXNzaW9uSUQgdG8gY2FsbCBhbiBhcmJpdHJhcnkgVzNDLW9ubHkgZW5kcG9pbnQgdGhhdCBpc24ndCBpbXBsZW1lbnRlZCB0byBzZWUgaWYgaXQgcmVzcG9uZHMgd2l0aCBjb3JyZWN0IGVycm9yXG4gICAgICBjb25zdCB7c3RhdHVzQ29kZSwgZXJyb3J9ID0gYXdhaXQgcmVxdWVzdC5wb3N0KHt1cmw6IGAke2Jhc2VVcmx9LyR7dmFsdWUuc2Vzc2lvbklkfS9leGVjdXRlL2FzeW5jYCwganNvbjoge3NjcmlwdDogJycsIGFyZ3M6IFsnYSddfX0pLnNob3VsZC5ldmVudHVhbGx5LmJlLnJlamVjdGVkO1xuICAgICAgc3RhdHVzQ29kZS5zaG91bGQuZXF1YWwoNDA1KTtcbiAgICAgIGNvbnN0IHtlcnJvcjogZXJyb3JNZXNzYWdlLCBtZXNzYWdlLCBzdGFja3RyYWNlfSA9IGVycm9yLnZhbHVlO1xuICAgICAgZXJyb3JNZXNzYWdlLnNob3VsZC5tYXRjaCgvdW5rbm93biBtZXRob2QvKTtcbiAgICAgIG1lc3NhZ2Uuc2hvdWxkLm1hdGNoKC9NZXRob2QgaGFzIG5vdCB5ZXQgYmVlbiBpbXBsZW1lbnRlZC8pO1xuICAgICAgc3RhY2t0cmFjZS5zaG91bGQubWF0Y2goL0Zha2VEcml2ZXIuZXhlY3V0ZUNvbW1hbmQvKTtcblxuICAgICAgLy8gRW5kIHNlc3Npb25cbiAgICAgIGF3YWl0IHJlcXVlc3QuZGVsZXRlKHt1cmw6IGAke2Jhc2VVcmx9LyR7dmFsdWUuc2Vzc2lvbklkfWB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVqZWN0IGludmFsaWQgVzNDIGNhcGFiaWxpdGllcyBhbmQgcmVzcG9uZCB3aXRoIGEgNDAwIEJhZCBQYXJhbWV0ZXJzIGVycm9yJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgYmFkVzNDY2FwcyA9IHtcbiAgICAgICAgY2FwYWJpbGl0aWVzOiB7XG4gICAgICAgICAgYWx3YXlzTWF0Y2g6IHt9LFxuICAgICAgICAgIGZpcnN0TWF0Y2g6IFt7J2FwcGl1bTpkZXZpY2VOYW1lJzogJ0Zha2UnLCAnYXBwaXVtOmFwcCc6IFRFU1RfRkFLRV9BUFB9XSxcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgY29uc3Qge3N0YXR1c0NvZGUsIGVycm9yfSA9IGF3YWl0IHJlcXVlc3QucG9zdCh7dXJsOiBiYXNlVXJsLCBqc29uOiBiYWRXM0NjYXBzfSkuc2hvdWxkLmV2ZW50dWFsbHkuYmUucmVqZWN0ZWQ7XG4gICAgICBzdGF0dXNDb2RlLnNob3VsZC5lcXVhbCg0MDApO1xuICAgICAgZXJyb3IudmFsdWUubWVzc2FnZS5zaG91bGQubWF0Y2goL2Nhbid0IGJlIGJsYW5rLyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFjY2VwdCBhIGNvbWJvIG9mIFczQyBhbmQgSlNPTldQIGNhcGFiaWxpdGllcyBidXQgZGVmYXVsdCB0byBXM0MnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBjb21iaW5lZENhcHMgPSB7XG4gICAgICAgICdkZXNpcmVkQ2FwYWJpbGl0aWVzJzoge1xuICAgICAgICAgIC4uLmNhcHMsXG4gICAgICAgIH0sXG4gICAgICAgICdjYXBhYmlsaXRpZXMnOiB7XG4gICAgICAgICAgJ2Fsd2F5c01hdGNoJzogey4uLmNhcHN9LFxuICAgICAgICAgICdmaXJzdE1hdGNoJzogW3tcbiAgICAgICAgICAgIHczY1BhcmFtOiAndzNjUGFyYW0nLFxuICAgICAgICAgIH1dLFxuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBjb25zdCB7c3RhdHVzLCB2YWx1ZSwgc2Vzc2lvbklkfSA9IGF3YWl0IHJlcXVlc3QucG9zdCh7dXJsOiBiYXNlVXJsLCBqc29uOiBjb21iaW5lZENhcHN9KTtcbiAgICAgIHNob3VsZC5ub3QuZXhpc3Qoc3RhdHVzKTsgLy8gSWYgaXQncyBhIFczQyBzZXNzaW9uLCBzaG91bGQgbm90IHJlc3BvbmQgd2l0aCAnc3RhdHVzJ1xuICAgICAgc2hvdWxkLm5vdC5leGlzdChzZXNzaW9uSWQpO1xuICAgICAgdmFsdWUuc2Vzc2lvbklkLnNob3VsZC5leGlzdDtcbiAgICAgIHZhbHVlLmNhcGFiaWxpdGllcy5zaG91bGQuZGVlcC5lcXVhbCh7XG4gICAgICAgIC4uLmNhcHMsXG4gICAgICAgIHczY1BhcmFtOiAndzNjUGFyYW0nLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIEVuZCBzZXNzaW9uXG4gICAgICBhd2FpdCByZXF1ZXN0LmRlbGV0ZSh7IHVybDogYCR7YmFzZVVybH0vJHt2YWx1ZS5zZXNzaW9uSWR9YCB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYWNjZXB0IGEgY29tYm8gb2YgVzNDIGFuZCBKU09OV1AgYW5kIGlmIEpTT05XUCBoYXMgZXh0cmFuZW91cyBrZXlzLCB0aGV5IHNob3VsZCBiZSBtZXJnZWQgaW50byBXM0MgY2FwYWJpbGl0aWVzJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgY29tYmluZWRDYXBzID0ge1xuICAgICAgICAnZGVzaXJlZENhcGFiaWxpdGllcyc6IHtcbiAgICAgICAgICAuLi5jYXBzLFxuICAgICAgICAgIGF1dG9tYXRpb25OYW1lOiAnRmFrZScsXG4gICAgICAgICAgYW5vdGhlclBhcmFtOiAnSGVsbG8nLFxuICAgICAgICB9LFxuICAgICAgICAnY2FwYWJpbGl0aWVzJzoge1xuICAgICAgICAgICdhbHdheXNNYXRjaCc6IHsuLi5jYXBzfSxcbiAgICAgICAgICAnZmlyc3RNYXRjaCc6IFt7XG4gICAgICAgICAgICB3M2NQYXJhbTogJ3czY1BhcmFtJyxcbiAgICAgICAgICB9XSxcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgY29uc3Qge3Nlc3Npb25JZCwgc3RhdHVzLCB2YWx1ZX0gPSBhd2FpdCByZXF1ZXN0LnBvc3Qoe3VybDogYmFzZVVybCwganNvbjogY29tYmluZWRDYXBzfSk7XG4gICAgICBzaG91bGQubm90LmV4aXN0KHNlc3Npb25JZCk7XG4gICAgICBzaG91bGQubm90LmV4aXN0KHN0YXR1cyk7XG4gICAgICB2YWx1ZS5zZXNzaW9uSWQuc2hvdWxkLmV4aXN0O1xuICAgICAgdmFsdWUuY2FwYWJpbGl0aWVzLnNob3VsZC5kZWVwLmVxdWFsKHtcbiAgICAgICAgLi4uY2FwcyxcbiAgICAgICAgYXV0b21hdGlvbk5hbWU6ICdGYWtlJyxcbiAgICAgICAgYW5vdGhlclBhcmFtOiAnSGVsbG8nLFxuICAgICAgICB3M2NQYXJhbTogJ3czY1BhcmFtJyxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBFbmQgc2Vzc2lvblxuICAgICAgYXdhaXQgcmVxdWVzdC5kZWxldGUoeyB1cmw6IGAke2Jhc2VVcmx9LyR7dmFsdWUuc2Vzc2lvbklkfWAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBiYWQgVzNDIGNhcGFiaWxpdGllcyB3aXRoIGEgQmFkUGFyYW1ldGVyc0Vycm9yICg0MDApJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgdzNjQ2FwcyA9IHtcbiAgICAgICAgY2FwYWJpbGl0aWVzOiB7XG4gICAgICAgICAgYWx3YXlzTWF0Y2g6IHtcbiAgICAgICAgICAgIC4uLmNhcHMsXG4gICAgICAgICAgICBhdXRvbWF0aW9uTmFtZTogJ0JhZEF1dG9tYXRpb25OYW1lJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHtlcnJvciwgc3RhdHVzQ29kZSwgcmVzcG9uc2V9ID0gYXdhaXQgcmVxdWVzdC5wb3N0KHt1cmw6IGJhc2VVcmwsIGpzb246IHczY0NhcHN9KS5zaG91bGQuZXZlbnR1YWxseS5iZS5yZWplY3RlZDtcbiAgICAgIHJlc3BvbnNlLmhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddLnNob3VsZC5tYXRjaCgvYXBwbGljYXRpb25cXC9qc29uLyk7XG5cbiAgICAgIGNvbnN0IHttZXNzYWdlfSA9IGVycm9yLnZhbHVlO1xuICAgICAgbWVzc2FnZS5zaG91bGQubWF0Y2goL0JhZEF1dG9tYXRpb25OYW1lIG5vdCBwYXJ0IG9mLyk7XG4gICAgICBzdGF0dXNDb2RlLnNob3VsZC5lcXVhbCg0MDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhY2NlcHQgY2FwYWJpbGl0aWVzIHRoYXQgYXJlIHByb3ZpZGVkIGluIHRoZSBmaXJzdE1hdGNoIGFycmF5JywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgdzNjQ2FwcyA9IHtcbiAgICAgICAgY2FwYWJpbGl0aWVzOiB7XG4gICAgICAgICAgYWx3YXlzTWF0Y2g6IHt9LFxuICAgICAgICAgIGZpcnN0TWF0Y2g6IFt7fSwge1xuICAgICAgICAgICAgLi4uY2Fwc1xuICAgICAgICAgIH1dLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHt2YWx1ZSwgc2Vzc2lvbklkLCBzdGF0dXN9ID0gYXdhaXQgcmVxdWVzdC5wb3N0KHt1cmw6IGJhc2VVcmwsIGpzb246IHczY0NhcHN9KTtcbiAgICAgIHNob3VsZC5ub3QuZXhpc3Qoc3RhdHVzKTtcbiAgICAgIHNob3VsZC5ub3QuZXhpc3Qoc2Vzc2lvbklkKTtcbiAgICAgIHZhbHVlLmNhcGFiaWxpdGllcy5zaG91bGQuZGVlcC5lcXVhbChjYXBzKTtcblxuICAgICAgLy8gRW5kIHNlc3Npb25cbiAgICAgIGF3YWl0IHJlcXVlc3QuZGVsZXRlKHsgdXJsOiBgJHtiYXNlVXJsfS8ke3ZhbHVlLnNlc3Npb25JZH1gIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmYWxsIGJhY2sgdG8gTUpTT05XUCBpZiB3M2MgY2FwcyBhcmUgaW52YWxpZCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGNvbWJpbmVkQ2FwcyA9IHtcbiAgICAgICAgZGVzaXJlZENhcGFiaWxpdGllczoge1xuICAgICAgICAgIC4uLmNhcHMsXG4gICAgICAgIH0sXG4gICAgICAgIGNhcGFiaWxpdGllczoge1xuICAgICAgICAgIGFsd2F5c01hdGNoOiB7fSxcbiAgICAgICAgICBmaXJzdE1hdGNoOiBbe30sIHtcbiAgICAgICAgICAgIC4uLmNhcHMsXG4gICAgICAgICAgICBkZXZpY2VOYW1lOiBudWxsLFxuICAgICAgICAgIH1dLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHt2YWx1ZSwgc2Vzc2lvbklkLCBzdGF0dXN9ID0gYXdhaXQgcmVxdWVzdC5wb3N0KHt1cmw6IGJhc2VVcmwsIGpzb246IGNvbWJpbmVkQ2Fwc30pO1xuICAgICAgc3RhdHVzLnNob3VsZC5leGlzdDtcbiAgICAgIHNlc3Npb25JZC5zaG91bGQuZXhpc3Q7XG4gICAgICB2YWx1ZS5zaG91bGQuZGVlcC5lcXVhbChjYXBzKTtcblxuICAgICAgLy8gRW5kIHNlc3Npb25cbiAgICAgIGF3YWl0IHJlcXVlc3QuZGVsZXRlKHsgdXJsOiBgJHtiYXNlVXJsfS8ke3Nlc3Npb25JZH1gIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmYWxsIGJhY2sgdG8gTUpTT05XUCBpZiBJbm5lciBEcml2ZXIgaXMgbm90IHJlYWR5IGZvciBXM0MnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBjb21iaW5lZENhcHMgPSB7XG4gICAgICAgIGRlc2lyZWRDYXBhYmlsaXRpZXM6IHtcbiAgICAgICAgICAuLi5jYXBzLFxuICAgICAgICB9LFxuICAgICAgICBjYXBhYmlsaXRpZXM6IHtcbiAgICAgICAgICBhbHdheXNNYXRjaDoge1xuICAgICAgICAgICAgLi4uY2FwcyxcbiAgICAgICAgICAgIGRldmljZU5hbWU6IG51bGwsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgICBjb25zdCBjcmVhdGVTZXNzaW9uU3R1YiA9IHNpbm9uLnN0dWIoRmFrZURyaXZlci5wcm90b3R5cGUsICdjcmVhdGVTZXNzaW9uJykuY2FsbHNGYWtlKGFzeW5jIGZ1bmN0aW9uIChqc29ud3BDYXBzKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IEJhc2VEcml2ZXIucHJvdG90eXBlLmNyZWF0ZVNlc3Npb24uY2FsbCh0aGlzLCBqc29ud3BDYXBzKTtcbiAgICAgICAgdGhpcy5wcm90b2NvbC5zaG91bGQuZXF1YWwoJ01KU09OV1AnKTtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB7dmFsdWUsIHNlc3Npb25JZCwgc3RhdHVzfSA9IGF3YWl0IHJlcXVlc3QucG9zdCh7dXJsOiBiYXNlVXJsLCBqc29uOiBjb21iaW5lZENhcHN9KTtcbiAgICAgIHN0YXR1cy5zaG91bGQuZXhpc3Q7XG4gICAgICBzZXNzaW9uSWQuc2hvdWxkLmV4aXN0O1xuICAgICAgdmFsdWUuc2hvdWxkLmRlZXAuZXF1YWwoY2Fwcyk7XG5cbiAgICAgIGNyZWF0ZVNlc3Npb25TdHViLnJlc3RvcmUoKTtcblxuICAgICAgLy8gRW5kIHNlc3Npb25cbiAgICAgIGF3YWl0IHJlcXVlc3QuZGVsZXRlKHsgdXJsOiBgJHtiYXNlVXJsfS8ke3Nlc3Npb25JZH1gIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29uY3VycmVudCBNSlNPTldQIGFuZCBXM0Mgc2Vzc2lvbnMnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBjb21iaW5lZENhcHMgPSB7XG4gICAgICAgIGRlc2lyZWRDYXBhYmlsaXRpZXM6IHtcbiAgICAgICAgICAuLi5jYXBzLFxuICAgICAgICB9LFxuICAgICAgICBjYXBhYmlsaXRpZXM6IHtcbiAgICAgICAgICBhbHdheXNNYXRjaDoge1xuICAgICAgICAgICAgLi4uY2FwcyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGZpcnN0TWF0Y2g6IFtdLFxuICAgICAgICB9LFxuICAgICAgfTtcblxuICAgICAgLy8gSGF2ZSBhbiBNSlNPTldQIGFuZCBXM0Mgc2Vzc2lvbiBydW5uaW5nIGNvbmN1cnJlbnRseVxuICAgICAgY29uc3Qge3Nlc3Npb25JZDogbWpzb253cFNlc3NJZCwgdmFsdWU6IG1qc29ud3BWYWx1ZSwgc3RhdHVzfSA9IGF3YWl0IHJlcXVlc3QucG9zdCh7dXJsOiBiYXNlVXJsLCBqc29uOiBfLm9taXQoY29tYmluZWRDYXBzLCAnY2FwYWJpbGl0aWVzJyl9KTtcbiAgICAgIHN0YXR1cy5zaG91bGQuZXhpc3Q7XG4gICAgICBtanNvbndwVmFsdWUuc2hvdWxkLmVxbChjYXBzKTtcbiAgICAgIG1qc29ud3BTZXNzSWQuc2hvdWxkLmV4aXN0O1xuXG4gICAgICBjb25zdCB7dmFsdWV9ID0gYXdhaXQgcmVxdWVzdC5wb3N0KHt1cmw6IGJhc2VVcmwsIGpzb246IF8ub21pdChjb21iaW5lZENhcHMsICdkZXNpcmVkQ2FwYWJpbGl0aWVzJyl9KTtcbiAgICAgIGNvbnN0IHczY1Nlc3NJZCA9IHZhbHVlLnNlc3Npb25JZDtcbiAgICAgIHczY1Nlc3NJZC5zaG91bGQuZXhpc3Q7XG4gICAgICB2YWx1ZS5jYXBhYmlsaXRpZXMuc2hvdWxkLmVxbChjYXBzKTtcblxuICAgICAgLy8gVGVzdCB0aGF0IGJvdGggcmV0dXJuIHRoZSBwcm9wZXIgcGF5bG9hZCBiYXNlZCBvbiB0aGVpciBwcm90b2NvbFxuICAgICAgY29uc3QgbWpzb253cFBheWxvYWQgPSBhd2FpdCByZXF1ZXN0KGAke2Jhc2VVcmx9LyR7bWpzb253cFNlc3NJZH1gLCB7anNvbjogdHJ1ZX0pO1xuICAgICAgbWpzb253cFBheWxvYWQuc2Vzc2lvbklkLnNob3VsZC5leGlzdDtcbiAgICAgIG1qc29ud3BQYXlsb2FkLnN0YXR1cy5zaG91bGQuZXhpc3Q7XG4gICAgICBtanNvbndwUGF5bG9hZC52YWx1ZS5zaG91bGQuZXFsKGNhcHMpO1xuXG4gICAgICBjb25zdCB3M2NQYXlsb2FkID0gYXdhaXQgcmVxdWVzdChgJHtiYXNlVXJsfS8ke3czY1Nlc3NJZH1gLCB7anNvbjogdHJ1ZX0pO1xuICAgICAgc2hvdWxkLm5vdC5leGlzdCh3M2NQYXlsb2FkLnNlc3Npb25JZCk7XG4gICAgICBzaG91bGQubm90LmV4aXN0KHczY1BheWxvYWQuc3RhdHVzKTtcbiAgICAgIHczY1BheWxvYWQudmFsdWUuc2hvdWxkLmVxbChjYXBzKTtcblxuICAgICAgLy8gRW5kIHNlc3Npb25zXG4gICAgICBhd2FpdCByZXF1ZXN0LmRlbGV0ZSh7dXJsOiBgJHtiYXNlVXJsfS8ke21qc29ud3BTZXNzSWR9YH0pO1xuICAgICAgYXdhaXQgcmVxdWVzdC5kZWxldGUoe3VybDogYCR7YmFzZVVybH0vJHt3M2NTZXNzSWR9YH0pO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuXG5kZXNjcmliZSgnTG9nc2luaycsIGZ1bmN0aW9uICgpIHtcbiAgbGV0IHNlcnZlciA9IG51bGw7XG4gIGxldCBsb2dzID0gW107XG4gIGxldCBsb2dIYW5kbGVyID0gZnVuY3Rpb24gKGxldmVsLCBtZXNzYWdlKSB7XG4gICAgbG9ncy5wdXNoKFtsZXZlbCwgbWVzc2FnZV0pO1xuICB9O1xuICBsZXQgYXJncyA9IHtcbiAgICBwb3J0OiBURVNUX1BPUlQsXG4gICAgaG9zdDogVEVTVF9IT1NULFxuICAgIGxvZ0hhbmRsZXIsXG4gIH07XG5cbiAgYmVmb3JlKGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICBzZXJ2ZXIgPSBhd2FpdCBhcHBpdW1TZXJ2ZXIoYXJncyk7XG4gIH0pO1xuXG4gIGFmdGVyKGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICBhd2FpdCBzZXJ2ZXIuY2xvc2UoKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBzZW5kIGxvZ3MgdG8gYSBsb2dIYW5kbGVyIHBhc3NlZCBpbiBieSBhIHBhcmVudCBwYWNrYWdlJywgZnVuY3Rpb24gKCkge1xuICAgIGxvZ3MubGVuZ3RoLnNob3VsZC5iZS5hYm92ZSgxKTtcbiAgICBsZXQgd2VsY29tZUluZGV4ID0gbG9nc1swXVsxXS5pbmNsdWRlcygndmVyc2lvbnMgb2Ygbm9kZScpID8gMSA6IDA7XG4gICAgbG9nc1t3ZWxjb21lSW5kZXhdLmxlbmd0aC5zaG91bGQuZXF1YWwoMik7XG4gICAgbG9nc1t3ZWxjb21lSW5kZXhdWzFdLnNob3VsZC5pbmNsdWRlKCdXZWxjb21lIHRvIEFwcGl1bScpO1xuICB9KTtcbn0pO1xuIl0sImZpbGUiOiJ0ZXN0L2RyaXZlci1lMmUtc3BlY3MuanMiLCJzb3VyY2VSb290IjoiLi4vLi4ifQ==
